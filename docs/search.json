[{"path":"https://jonathonchow.github.io/SPA/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2024 SPA authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://jonathonchow.github.io/SPA/articles/SPA_logistic.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Saddlepoint Approximations Method in Logistic Regression Model","text":"traditional score test approximates null distribution using normal distribution depends mean variance score statistic. performance especially poor underlying distribution highly skewed, unbalanced case-control outcomes, since normal approximation incorporate higher moments skewness. Saddlepoint approximation improvement normal approximation. Contrary normal approximation, first two cumulants (mean variance) used approximate underlying distribution, saddlepoint approximation uses entire cumulant generating function.","code":"library(SPA)"},{"path":"https://jonathonchow.github.io/SPA/articles/SPA_logistic.html","id":"model-and-methods","dir":"Articles","previous_headings":"","what":"Model and Methods","title":"Saddlepoint Approximations Method in Logistic Regression Model","text":"relate genotypes phenotypes, Dey et al. (2017) use following logistic regression model: \\[\\text{logit}[\\Pr(Y_i=1\\mid X_i,G_i)]=X_i^{\\top}\\beta+G_i\\gamma,\\,\\text{}\\,=1,\\ldots,n.\\] Consider every \\(\\), test \\(H_0:\\gamma=0\\). Fit null model get \\(\\hat\\mu_i\\); Solve score statistic \\(S\\) \\(\\gamma\\); Use SPA, compute CGF \\(K(t)\\) derivatives; Find distribution \\(\\Pr(S<s)\\) p value.","code":""},{"path":"https://jonathonchow.github.io/SPA/articles/SPA_logistic.html","id":"numerical-simulations","dir":"Articles","previous_headings":"","what":"Numerical Simulations","title":"Saddlepoint Approximations Method in Logistic Regression Model","text":"Fit logistic model different MAF, ccratio, methods.","code":"pval <- 0 pval.NA <- 0 alpha <- 0.01 for (j in 1:500) {   simu <- logistic_simulation(cases = 100, controls = 19900, maf = 0.005) # ccratio = 0.5%, maf = 0.005   result <- logistic_spa(simu$genos, simu$pheno, simu$cov, minmac = 5, cutoff = 2, log.p = FALSE)   pval <- c(pval, result$p.value)   pval.NA <- c(pval.NA, result$p.value.NA) } pval <- pval[-1] pval <- pval[!is.na(pval)] pval.NA <- pval.NA[-1] pval.NA <- pval.NA[!is.na(pval.NA)] length(pval[pval < alpha]) / length(pval) ## [1] 0.004 length(pval.NA[pval.NA < alpha]) / length(pval.NA) ## [1] 0.008 gg_qqplot(pval) gg_qqplot(pval.NA)"},{"path":[]},{"path":"https://jonathonchow.github.io/SPA/articles/SPA_negbinom.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Saddlepoint Approximations Method in Negative Binomial Generalized Linear Model","text":"","code":"library(SPA)"},{"path":[]},{"path":[]},{"path":[]},{"path":"https://jonathonchow.github.io/SPA/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Jonathon Chow. Author, maintainer.","code":""},{"path":"https://jonathonchow.github.io/SPA/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Chow J (2024). SPA: Saddlepoint Approximations. https://github.com/JONATHONCHOW/SPA, https://jonathonchow.github.io/SPA/.","code":"@Manual{,   title = {SPA: Saddlepoint Approximations},   author = {Jonathon Chow},   year = {2024},   note = {https://github.com/JONATHONCHOW/SPA, https://jonathonchow.github.io/SPA/}, }"},{"path":"https://jonathonchow.github.io/SPA/index.html","id":"spa","dir":"","previous_headings":"","what":"Saddlepoint Approximations","title":"Saddlepoint Approximations","text":"goal SPA use SPA methods perturb-seq data.","code":""},{"path":"https://jonathonchow.github.io/SPA/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Saddlepoint Approximations","text":"can install development version SPA GitHub :","code":"# install.packages(\"devtools\") devtools::install_github(\"JONATHONCHOW/SPA\")"},{"path":"https://jonathonchow.github.io/SPA/index.html","id":"example","dir":"","previous_headings":"","what":"Example","title":"Saddlepoint Approximations","text":"","code":"library(SPA) hello_world() #> [1] \"Data science is fantastic!\""},{"path":"https://jonathonchow.github.io/SPA/reference/gg_qqplot.html","id":null,"dir":"Reference","previous_headings":"","what":"Draw QQ plot — gg_qqplot","title":"Draw QQ plot — gg_qqplot","text":"Draw QQ plot p values.","code":""},{"path":"https://jonathonchow.github.io/SPA/reference/gg_qqplot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Draw QQ plot — gg_qqplot","text":"","code":"gg_qqplot(ps, ci = 0.95)"},{"path":"https://jonathonchow.github.io/SPA/reference/gg_qqplot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Draw QQ plot — gg_qqplot","text":"ps vector element observed p value. ci parameter control tolerance.","code":""},{"path":"https://jonathonchow.github.io/SPA/reference/gg_qqplot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Draw QQ plot — gg_qqplot","text":"QQ plot p values.","code":""},{"path":"https://jonathonchow.github.io/SPA/reference/gg_qqplot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Draw QQ plot — gg_qqplot","text":"","code":"gg_qqplot(stats::runif(100, min = 0, max = 1))"},{"path":"https://jonathonchow.github.io/SPA/reference/hello_world.html","id":null,"dir":"Reference","previous_headings":"","what":"Hello world — hello_world","title":"Hello world — hello_world","text":"Initialize SPA package.","code":""},{"path":"https://jonathonchow.github.io/SPA/reference/hello_world.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Hello world — hello_world","text":"","code":"hello_world()"},{"path":"https://jonathonchow.github.io/SPA/reference/hello_world.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Hello world — hello_world","text":"string \"Data science fantastic!\".","code":""},{"path":"https://jonathonchow.github.io/SPA/reference/hello_world.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Hello world — hello_world","text":"","code":"hello_world() #> [1] \"Data science is fantastic!\""},{"path":"https://jonathonchow.github.io/SPA/reference/logistic_simulation.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulations in logistic regression — logistic_simulation","title":"Simulations in logistic regression — logistic_simulation","text":"Numerical simulations logistic regression model.","code":""},{"path":"https://jonathonchow.github.io/SPA/reference/logistic_simulation.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulations in logistic regression — logistic_simulation","text":"","code":"logistic_simulation(   cases,   controls,   maf,   X1prob1_case = 0.7260159,   X1prob1_control = 0.4974979,   samplerX2_given_Y1 = arscpp::ars(f = Log_Dens_X2_given_Y1, f_prime =     Log_Dens_X2_given_Y1_prime, xlb = -Inf, xrb = Inf, x = c(-2, 0, 2), beta0 = -5.6,     prevalence = 0.0109492),   samplerX2_given_Y0 = arscpp::ars(f = Log_Dens_X2_given_Y0, f_prime =     Log_Dens_X2_given_Y0_prime, xlb = -Inf, xrb = Inf, x = c(-2, 0, 2), beta0 = -5.6,     prevalence = 0.0109492) )"},{"path":"https://jonathonchow.github.io/SPA/reference/logistic_simulation.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulations in logistic regression — logistic_simulation","text":"cases integer denoting number cases. controls integer denoting number controls. maf real number denoting minor allele frequency. X1prob1_case real number denoting probability X1 = 1 given Y1 = 1. X1prob1_control real number denoting probability X1 = 1 given Y1 = 0. samplerX2_given_Y1 output function arscpp::ars denoting sampler X2 given Y1 = 1. samplerX2_given_Y0 output function arscpp::ars denoting sampler X2 given Y1 = 0.","code":""},{"path":"https://jonathonchow.github.io/SPA/reference/logistic_simulation.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulations in logistic regression — logistic_simulation","text":"list simulated data.","code":""},{"path":"https://jonathonchow.github.io/SPA/reference/logistic_simulation.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Simulations in logistic regression — logistic_simulation","text":"Dey, Rounak, et al. \"fast accurate algorithm test binary phenotypes application PheWAS.\" American Journal Human Genetics 101.1 (2017): 37-49.","code":""},{"path":"https://jonathonchow.github.io/SPA/reference/logistic_simulation.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simulations in logistic regression — logistic_simulation","text":"","code":"# See vignettes"},{"path":"https://jonathonchow.github.io/SPA/reference/logistic_spa.html","id":null,"dir":"Reference","previous_headings":"","what":"Basic SPA in logistic regression — logistic_spa","title":"Basic SPA in logistic regression — logistic_spa","text":"Basic saddlepoint approximation method logistic regression model.","code":""},{"path":"https://jonathonchow.github.io/SPA/reference/logistic_spa.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Basic SPA in logistic regression — logistic_spa","text":"","code":"logistic_spa(   genos,   pheno,   cov,   obj.null,   minmac = 5,   cutoff = 2,   log.p = FALSE )"},{"path":"https://jonathonchow.github.io/SPA/reference/logistic_spa.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Basic SPA in logistic regression — logistic_spa","text":"genos vector matrix containing genotypes. matrix provided rows correspond SNPs columns correspond subjects. Optional, needed obj.null missing. pheno vector containing phenotypes. Optional, needed obj.null missing. cov matrix data frame containing covariates. Optional, needed obj.null missing. obj.null object class \"logistic_null\". (Optional) minmac integer denoting minimum minor allele count threshold run SPA test. Default value 5. cutoff integer denoting standard deviation cutoff used. test statistic lies within standard deviation cutoff mean, p-value based traditional score test returned. Default value 2. log.p Boolean value determines whether return natural log-transformed p-values. Default value FALSE.","code":""},{"path":"https://jonathonchow.github.io/SPA/reference/logistic_spa.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Basic SPA in logistic regression — logistic_spa","text":"list p values.","code":""},{"path":"https://jonathonchow.github.io/SPA/reference/logistic_spa.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Basic SPA in logistic regression — logistic_spa","text":"Dey, Rounak, et al. \"fast accurate algorithm test binary phenotypes application PheWAS.\" American Journal Human Genetics 101.1 (2017): 37-49.","code":""},{"path":"https://jonathonchow.github.io/SPA/reference/logistic_spa.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Basic SPA in logistic regression — logistic_spa","text":"","code":"# See vignettes"},{"path":"https://jonathonchow.github.io/SPA/reference/negbinom_spa.html","id":null,"dir":"Reference","previous_headings":"","what":"Basic SPA in NB generalized linear model — negbinom_spa","title":"Basic SPA in NB generalized linear model — negbinom_spa","text":"Basic saddlepoint approximation method NB generalized linear model.","code":""},{"path":"https://jonathonchow.github.io/SPA/reference/negbinom_spa.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Basic SPA in NB generalized linear model — negbinom_spa","text":"","code":"negbinom_spa(   perturbation,   gene,   cov,   obj.null,   minperturb = 5,   cutoff = 2,   log.p = FALSE )"},{"path":"https://jonathonchow.github.io/SPA/reference/negbinom_spa.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Basic SPA in NB generalized linear model — negbinom_spa","text":"perturbation vector matrix containing perturbation indicators. Optional, needed obj.null missing. gene vector containing gene expressions. Optional, needed obj.null missing. cov matrix data frame containing covariates. Optional, needed obj.null missing. obj.null object class \"logistic_null\". (Optional) minperturb integer denoting minimum perturbation number. Default value 5. cutoff integer denoting standard deviation cutoff used. test statistic lies within standard deviation cutoff mean, p-value based traditional score test returned. Default value 2. log.p Boolean value determines whether return natural log-transformed p-values. Default value FALSE.","code":""},{"path":"https://jonathonchow.github.io/SPA/reference/negbinom_spa.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Basic SPA in NB generalized linear model — negbinom_spa","text":"list p values.","code":""},{"path":"https://jonathonchow.github.io/SPA/reference/negbinom_spa.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Basic SPA in NB generalized linear model — negbinom_spa","text":"","code":"# See vignettes"},{"path":"https://jonathonchow.github.io/SPA/news/index.html","id":"spa-000","dir":"Changelog","previous_headings":"","what":"SPA 0.0.0","title":"SPA 0.0.0","text":"Initial CRAN submission.","code":""},{"path":"https://jonathonchow.github.io/SPA/news/index.html","id":"spa-010","dir":"Changelog","previous_headings":"","what":"SPA 0.1.0","title":"SPA 0.1.0","text":"Apply SPA method logistic regression model.","code":""},{"path":"https://jonathonchow.github.io/SPA/news/index.html","id":"spa-020","dir":"Changelog","previous_headings":"","what":"SPA 0.2.0","title":"SPA 0.2.0","text":"Apply SPA method NB generalized linear model.","code":""}]
